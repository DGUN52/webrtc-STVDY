import{e as q,j as D,s as b,i as Q,f as B,o as l,c as d,a as _,b as o,t as m,u as n,d as f,w,m as p,F as $,l as E,r as k,p as F}from"./index-4903a14b.js";import{F as N,a as T}from"./vee-validate.esm-07fa51b8.js";const I={style:{color:"white"}},V=o("br",null,null,-1),P=o("br",null,null,-1),U=o("br",null,null,-1),j=o("br",null,null,-1),J={key:0},K=o("div",null," 답변 ",-1),L=o("button",null,"답변 등록하기",-1),O={key:1},R={key:0},z={key:0},G=["onClick"],H=["id"],M={key:2},W=["onClick"],X=["onClick"],te={__name:"QtnDetail",setup(Y){const c=q(),a=D(),{question:i}=b(c),h=Q(JSON.parse(localStorage.getItem("user"))),{answers:y}=b(c);function C(t){c.pickedQtn=t,k.push("CreateQtn")}async function v(t){if(confirm("질문을 삭제할까요?"))try{await c.delete(t),await k.push("question"),a.success("질문이 삭제되었습니다.")}catch(r){a.error(r)}}async function g(t){t.user_id=h._value.id;const s=c.pickedQtn;t.question_id=s,console.log(t);try{await c.createAnswer(t),await k.push("qtndetail"),a.success("답변이 등록되었습니다."),document.getElementById("answer-field").value="??????"}catch(r){a.error(r)}}async function A(t,s){console.log(t);const r=document.getElementById(t),e=document.createElement("textarea"),u=document.createElement("button");u.setAttribute(onClick,`deleteAnswer${t}`),e.innerText=s,u.innerText="취소",r.appendChild(e),r.appendChild(u),console.log(s)}async function x(t){if(confirm("답변을 삭제할까요?"))try{await c.deleteAnswer(t),a.success("답변이 삭제되었습니다.")}catch(r){a.error(r)}}async function S(t){try{c.awardAnswer(t),a.success("답변이 채택되었습니다.")}catch(s){a.error(s)}}return(t,s)=>{const r=B("router-link");return l(),d("div",I,[V,_("질문 상세 "),o("div",null,[_(" 질문 번호 "+m(n(i).id),1),P,_(" 질문 제목 "+m(n(i).title),1),U,_(" 질문 내용 "+m(n(i).detail),1),j,_(" 질문작성 시간 "+m(n(i).regist_time),1)]),f(r,{to:"question"},{default:w(()=>[_("목록으로 돌아가기")]),_:1}),n(i).user_id===h.value.id?(l(),d("span",J,[o("button",{onClick:s[0]||(s[0]=e=>C(n(i).id))}," 수정하기 "),o("button",{onClick:s[1]||(s[1]=e=>v(n(i).id))}," 삭제하기 ")])):p("",!0),K,f(n(T),{onSubmit:g},{default:w(()=>[f(n(N),{name:"detail"},{default:w(({field:e})=>[o("textarea",F({id:"answer-field"},e,{type:"text",name:"detail"}),null,16)]),_:1}),L]),_:1}),n(y).length?(l(),d("div",O,[(l(!0),d($,null,E(n(y),e=>(l(),d("tr",{key:e.id},[e.question_id==n(i).id?(l(),d("div",R,[n(i).best_answer===e.id?(l(),d("td",z,"채택됨!")):p("",!0),o("td",null,"작성자 PK: "+m(e.user_id),1),o("td",null,"답변 내용: "+m(e.detail),1),n(i).user_id===h.value.id&&e.user_id!=h.value.id&&n(i).best_answer===null?(l(),d("button",{key:1,onClick:u=>S(e.id)}," 채택하기 ",8,G)):p("",!0),o("span",{id:e.id},null,8,H),e.user_id===h.value.id?(l(),d("span",M,[o("button",{onClick:u=>A(e.id,e.detail)},"수정하기",8,W),o("button",{onClick:u=>x(e.id)},"삭제하기",8,X)])):p("",!0)])):p("",!0)]))),128))])):p("",!0)])}}};export{te as default};
