import{s as q,k as B,A as b,B as D,r as Q,o as l,c as d,e as _,b as s,t as m,d as n,a as k,w,x as p,F as $,v as E,h as f,y as F}from"./index-224b7266.js";import{F as N,a as T}from"./vee-validate.esm-d85c4787.js";const I={style:{color:"white"}},V=s("br",null,null,-1),U=s("br",null,null,-1),P=s("br",null,null,-1),J=s("br",null,null,-1),K={key:0},L=s("div",null,"답변",-1),O=s("button",null,"답변 등록하기",-1),R={key:1},j={key:0},z={key:0},G=["onClick"],H=["id"],M={key:2},W=["onClick"],X=["onClick"],te={__name:"QuestionDetail",setup(Y){const c=q(),a=B();userUserStore();const{question:i}=b(c),h=D(JSON.parse(localStorage.getItem("user"))),{answers:y}=b(c);function v(t){c.pickedQtn=t,f.push("CreateQtn")}async function C(t){if(confirm("질문을 삭제할까요?"))try{await c.delete(t),await f.push("question"),a.success("질문이 삭제되었습니다.")}catch(r){a.error(r)}}async function A(t){t.user_id=h._value.id;const o=c.pickedQtn;t.question_id=o,console.log(t);try{await c.createAnswer(t),await f.push("questiondetail"),a.success("답변이 등록되었습니다."),document.getElementById("answer-field").value="??????"}catch(r){a.error(r)}}async function g(t,o){console.log(t);const r=document.getElementById(t),e=document.createElement("textarea"),u=document.createElement("button");u.setAttribute(onClick,`deleteAnswer${t}`),e.innerText=o,u.innerText="취소",r.appendChild(e),r.appendChild(u),console.log(o)}async function x(t){if(confirm("답변을 삭제할까요?"))try{await c.deleteAnswer(t),a.success("답변이 삭제되었습니다.")}catch(r){a.error(r)}}async function S(t){try{c.awardAnswer(t),a.success("답변이 채택되었습니다.")}catch(o){a.error(o)}}return(t,o)=>{const r=Q("router-link");return l(),d("div",I,[V,_(" 질문 상세 "),s("div",null,[_(" 질문 번호 "+m(n(i).id)+" ",1),U,_(" 질문 제목 "+m(n(i).title)+" ",1),P,_(" 질문 내용 "+m(n(i).detail)+" ",1),J,_(" 질문작성 시간 "+m(n(i).regist_time),1)]),k(r,{to:"question"},{default:w(()=>[_("목록으로 돌아가기")]),_:1}),n(i).user_id===h.value.id?(l(),d("span",K,[s("button",{onClick:o[0]||(o[0]=e=>v(n(i).id))},"수정하기"),s("button",{onClick:o[1]||(o[1]=e=>C(n(i).id))},"삭제하기")])):p("",!0),L,k(n(T),{onSubmit:A},{default:w(()=>[k(n(N),{name:"detail"},{default:w(({field:e})=>[s("textarea",F({id:"answer-field"},e,{type:"text",name:"detail"}),null,16)]),_:1}),O]),_:1}),n(y).length?(l(),d("div",R,[(l(!0),d($,null,E(n(y),e=>(l(),d("tr",{key:e.id},[e.question_id==n(i).id?(l(),d("div",j,[n(i).best_answer===e.id?(l(),d("td",z,"채택됨!")):p("",!0),s("td",null,"작성자 PK: "+m(e.user_id),1),s("td",null,"답변 내용: "+m(e.detail),1),n(i).user_id===h.value.id&&e.user_id!=h.value.id&&n(i).best_answer===null?(l(),d("button",{key:1,onClick:u=>S(e.id)}," 채택하기 ",8,G)):p("",!0),s("span",{id:e.id},null,8,H),e.user_id===h.value.id?(l(),d("span",M,[s("button",{onClick:u=>g(e.id,e.detail)},"수정하기",8,W),s("button",{onClick:u=>x(e.id)},"삭제하기",8,X)])):p("",!0)])):p("",!0)]))),128))])):p("",!0)])}}};export{te as default};
